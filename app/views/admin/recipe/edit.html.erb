<%= stylesheet_link_tag 'ingredient', 'admin-manage', 'admin', media: 'all', 'data-turbolinks-track': 'reload' %>

<div class="header">
	<div class="inside_head">
		<%= image_tag 'house.png', :class => "iconLil" %>
		<%= link_to 'Home', admin_admin_index_path, :class => 'homeBTN' %>
	</div>
</div>
<% end %>

<div class="admin_sub">
	<h1 class="admin_sub_inside">Edit Recipe</h1>
  <hr class="hr">
  <div class="insub">
		<%= form_with model: @recipe, url: admin_recipe_path(@recipe), local: true do |form| %>

		  <% if @recipe.errors.any? %>
		    <div id="error_explanation">
		      <h2>
		        <%= pluralize(@recipe.errors.count, "error") %> prohibited
		        this recipe from being saved:
		      </h2>
		      <ul>
		        <% @recipe.errors.full_messages.each do |msg| %>
		          <li><%= msg %></li>
		        <% end %>
		      </ul>
		    </div>
		  <% end %>

		  <p class="label_new">
		    <%= form.label :name %><br>
		    <%= form.text_field :name, class: "inputs" %>
		  </p>

			<div class="img_area_admin_edit">
				<% IngreCategory.all.each do |inca| %>
					<div class="admin_rec_edit_out">
						<a class="cat_btn" onclick="ingre_show(<%=inca.id%>)">
					    <%=inca.name%><br>
					    <% if inca.image.full.url %>
					    	<%= image_tag inca.image.full.url, class: 'img_rec' %>
					    <% else %>
					      <%= image_tag asset_path("tomato.png"), class: 'img_rec'%>
					    <% end %>
					 	</a>
				    <div id=<%=inca.id%>>
					   	<% Ingredient.where("ingre_category_id = ?", inca.id).each do |ingre| %>
								<span class="admin_rec_edit_span">
									<% if RecipeAndIngredient.where("recipe_id = ?", @recipe.id).pluck(:ingredient_id).include?(ingre.id) %>
										<%= check_box_tag "ingredient_id[]", ingre.id, true %>									      <%= ingre.name %>
						      <% else %>
							      <%= check_box_tag "ingredient_id[]", ingre.id %>
						        <%= ingre.name %>
			          	<% end %>
								</span>
					    <% end %>
				    </div>
					</div>
		  	<% end %>
			</div>

		  <p class="label_new">
		    <%= form.label :instruction %><br>
		    <%= form.text_area :instruction, class: "input_inst" %>
		  </p>

		  <p class="label_new">
		    <%= form.label :image %><br>
		    <span class="sbtn"><%= form.file_field :image, class: "image" %></span>
		  </p>

		  <p class="label_new">
		    <%= collection_select(:recipe, :rec_category_id, RecCategory.all, :id, :name)%>
		  </p>

		  <p class="label_new">
		    <%= form.hidden_field :author_id, value: 0, class: "inputs" %>
		  </p>

		  <p>
		    <%= form.submit :save, class: "submit" %>
		  </p>
		<% end %>

		<%= link_to 'Back', admin_recipe_index_path, class: "btn-user" %>

		<script>

		function ingre_show(inca_id){
		    var x = document.getElementById(inca_id);

		    var clas = document.getElementsByClassName("content");

		  if(x.style.display === "none"){
		    for (var i = 0; i < clas.length; i++) {
		    clas[i].style.display = "none";
		    }
		    x.style.display = "inline";
		  }
		  else{
		        x.style.display = "none";

		    }
		}
		</script>
	</div>
</div>
